\pagestyle{fancy}
\usepackage{lastpage}
\usepackage{fancyhdr}
\fancypagestyle{front}
{
\fancyhf{}
\lhead{}
\chead{}
\rhead{}
\lfoot{}
\cfoot{\thepage}
\rfoot{}
\renewcommand{\headrulewidth}{0pt}
 } 

\fancypagestyle{main}
{
\fancyhf{}
\lhead{}
\chead{}
\rhead{\it\small\leftmark}
\lfoot{}
\cfoot{\thepage\ of \pageref{LastPage}}%当前页 of 总页数
\rfoot{}
\renewcommand{\headrulewidth}{0.1pt}%改为0pt即可去掉页眉下面的横线
\renewcommand{\footrulewidth}{0.1pt}%改为0pt即可去掉页脚上面的横线
}
\makeatletter
  \newcommand\frontpagestyle{\cleardoublepage\pagestyle{front}\let\ps@plain\ps@front}
  \newcommand\mainpagestyle{\cleardoublepage\pagestyle{main}\let\ps@plain\ps@main}
\makeatother
